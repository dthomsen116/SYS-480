function 480Banner(){
    $bannerHead = @'
     ____  _  _   __   _  _  ____  ____  __ _     ____  _  _  ____        ___  ____   __  
    (_  _)/ )( \ /  \ ( \/ )/ ___)(  __)(  ( \   / ___)( \/ )/ ___) ___  / _ \/ _  \ /  \ 
      )(  ) __ ((  O )/ \/ \\___ \ ) _) /    / _ \___ \ )  / \___ \(___)(__  () _  ((  O )
     (__) \_)(_/ \__/ \_)(_/(____/(____)\_)__)(_)(____/(__/  (____/       (__/\____/ \__/ 
'@
     
    $banner1 = @'

                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⡀⠤⠤⡤⠤⣀⣀⡀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡠⢔⠲⠈⠉⠀⠀⠀⠀⡸⠀⠀⠈⣿⣿⣦⡀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡠⠂⡡⠄⠀⠀⠀⠀⠀⠈⠀⠀⢇⠀⠀⠀⣿⣿⣿⣷⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠀⡰⢁⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⠀⠀⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠎⢀⣡⠴⠒⠈⠉⠉⢉⣩⣿⣶⣦⣄⡀⠀⡆⠀⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠀⠀⠀⠀⠀⣼⣴⠉⠀⢀⠖⠉⠉⠙⠿⣿⣿⣿⣿⣿⣿⣷⣼⡀⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠀⠀⠀⠀⠀⢻⣿⣄⣴⠏⠀⠀⠀⠀⠀⠙⣿⣿⣿⡿⠿⠛⠁⡇⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⡹⠛⠁⠀⠀⠀⠀⠀⠀⠀⠈⠉⠀⠀⠀⠀⠀⡇⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠀⠀⠀⠀⢀⡔⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡇⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠀⠀⠀⡠⠊⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⠀⠀⣿⣿⣿⣿⠀
                        ⠀⠀⢀⠔⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡜⠀⠀⣿⣿⣿⣿⠀
                        ⠀⠠⡃⢠⡤⠤⣀⣀⣀⡀⠀⠀⠀⢣⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠇⠀⠀⣿⣿⣿⣿⠀
                        ⠀⠀⠑⢼⣧⣀⣴⣿⣿⣿⣿⣷⣦⣄⠇⠀⠀⠀⠀⠀⠀⠀⠀⢰⠀⠀⠀⣿⣿⣿⣿⡇
                        ⠀⠀⠀⣼⢠⠀⠈⠍⠉⠛⠛⠛⠛⠛⠃⠀⠀⠀⠀⠀⠀⠀⢀⡇⢠⠀⠀⣿⣿⣿⣿⢇
                        ⠀⠀⠀⡏⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣶⣤⣷⣶⣿⣿⣿⠏⠀
                        ⠀⠀⢸⠇⢀⠀⣀⣀⣀⣀⣀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣿⣿⣿⣿⣿⡟⠉⠃⠀⠀
                        ⠀⠀⢸⠀⡇⠮⣀⣀⣤⣤⣭⣽⣿⣄⠀⠀⠀⠀⠀⠀⢠⣿⣿⣿⣿⣿⣿⡇⠀⠀⠀⠀
                        ⠀⠀⡇⠰⠐⠲⠾⠿⠿⠿⠿⠟⠛⠛⠋⠀⠀⠀⠀⢠⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀
                        ⠀⢸⢁⠇⡔⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠀⠀⠀
                        ⠀⠏⠸⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⠀⠀
                        ⢸⠀⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠇⠀⠀
                        ⠀⠑⠢⠤⠀⠀⠀⠀⠀⠒⣄⣀⠠⠶⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠋⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⡜⢠⠃⠀⠀⠀⠀⠻⣿⣿⣿⣿⣿⣿⣿⠿⠟⠋⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠰⠁⠈⠀⠀⠀⠀⣤⣶⣿⡿⠿⠿⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
                        ⠀⠀⠀⠀⠀⠀⠀⠀⠉⠐⠒⠒⠂⠈⠉⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
'@
    $banner2 = @'
        
                    ⠀                                  ,---------,
                  ,-----------------------,          ,"         ,"|
                ,"                      ,"|        ,"         ,"  |
                +-----------------------+  |      ,"        ,"    |
                |  .-----------------.  |  |     +---------+      |
                |  |                 |  |  |     | -==----'|      |
                |  |  Powershell.lol |  |  |     |         |      |
                |  |  Error404       |  |  |/----|`---=    |      |
                |  |  C:\>_          |  |  |   ,/|==== ooo |      ;
                |  |                 |  |  |  // |(((( [33]|    ,"
                |  `-----------------'  |," .;'| |((((     |  ,"
                +-----------------------+  ;;  | |         |,"     
                    /_)______________(_/  //'   | +---------+
            ___________________________/___  `,
            /  oooooooooooooooo  .o.  oooo /,   \,"-----------
            / ==ooooooooooooooo==.o.  ooo= //   ,`\--{)B     ,"
            /_==__==========__==_ooo__ooo=_/'   /___________,"        

'@
    $banner3 = @'
        
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣤⣀⡀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⠋⠀⠈⠙⣦⣴⠞⠛⢶⡄
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⡀⠀⠀⠀⠈⠀⠀⠀⢸⡇
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⢷⡄⠀⠀⠀⠀⠀⢀⣼⠃
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣆⠀⠀⢀⣴⠟⠁⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⣇⣴⠟⠁⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠋⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⣤⣶⣶⣶⣤⣤⣀⡀⢀⣴⣿⠿⠿⢿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣀⣤⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⣼⣿⠋⠉⠉⠙⠻⠿⣿⣿⡟⠁⠀⠀⠀⠙⢿⣷⣤⣤⣤⣤⣤⣄⣀⣤⣶⣾⣿⠿⠛⠛⠿⣿⡆⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⢠⣿⡇⠀⠀⠀⠀⢀⣀⣾⣿⣠⣤⣤⣄⠀⠀⠈⣿⣿⠛⠛⠛⠛⠻⠿⠟⠋⠁⠀⠀⠀⠀⠀⢻⣿⡄⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⣸⣿⣿⣶⣿⣶⣶⣿⠟⠛⠻⣿⣯⣙⣿⠆⠀⠀⢸⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣿⡇⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⢰⣿⠋⠀⠀⢀⣸⣿⠁⠀⠀⠀⠈⣿⣿⠛⠀⠀⠀⣼⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣸⣿⡇⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⢻⣿⡀⠀⠀⣾⡟⣿⣇⠀⠀⠀⣠⣿⣿⣷⣶⣶⣿⠿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠻⣿⣿⠁⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠈⢿⣷⣄⠀⠙⠿⠿⠻⣿⣶⣾⠟⠋⠀⠀⠈⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣿⣆⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⢀⣿⡿⣿⣶⣤⣀⣤⣾⡿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢹⣿⡄⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⣼⣿⠃⠀⠉⠛⠛⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⣧⠀⠀⠀⠀⠀
                    ⣤⣤⣤⣤⣿⣿⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣿⣿⣀⠀⠀⠀⠀
                    ⠉⠉⠉⠉⣿⣿⠉⠛⠃⠀⠀⠀⠀⣤⣶⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣶⣶⣆⠀⠀⠀⠘⠿⠿⣿⡿⠿⠿⠿⠿⠀
                    ⠀⢀⣀⣀⣿⣿⣤⡄⠀⠀⠀⠀⠘⣿⣿⡇⠀⠀⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⠀⠀⠀⠈⣿⣿⡟⠀⠀⠀⢀⣀⣠⣿⡇⠀⠀⠀⠀⠀
                    ⠀⠛⠟⠛⠛⣿⣯⠀⠀⠀⠀⠀⠀⠈⠋⠁⠀⠀⠀⠀⠀⣴⡿⠛⢻⣷⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢛⣿⣿⣷⣶⡄⠀⠀⠀
                    ⠀⠀⠀⠀⠀⣸⣿⣷⣶⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠻⠿⠟⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢴⣦⣤⣾⡟⠁⠀⠀⠀⠀⠀⠀
                    ⠀⠀⢠⣶⡿⠿⠛⢿⣿⣆⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣿⡿⠿⣿⣦⣄⠀⠀⠀⠀⠀
                    ⠀⠀⠈⠉⠀⠀⠀⠀⠙⠻⣿⣷⣦⣄⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣠⣤⣶⣤⣤⣤⣴⡾⠿⠛⠉⠀⠀⠀⠙⠛⠃⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠻⠿⢿⣿⣿⣿⣷⣶⣶⣶⣿⣿⣿⣿⠟⠉⠁⠉⠻⣿⣯⣶⣿⣿⣶⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣾⣿⠃⣠⣴⣶⣶⣶⣶⣿⣇⠀⠀⠀⠀⠀⠘⠛⠁⠀⠀⠈⠻⣿⡄⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⣿⠃⣼⡿⠋⠀⠀⠈⣹⣿⠿⠿⢿⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⡿⠁⠀⣿⣇⠀⠀⠀⣼⣿⠏⠀⠀⠀⣿⣧⠀⠀⠀⠀⠀⠀⠀⣰⣿⠇⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣿⣿⠃⠀⠀⠸⣿⣦⡀⣰⣿⠏⠀⠀⠀⠀⢹⣿⠀⠀⠀⠀⢀⣠⣾⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⢀⣴⣶⣿⣿⣿⣿⠇⠀⠀⠀⠀⠈⠻⣿⣿⣏⡀⠀⠀⢀⣰⣿⠏⠀⢀⣠⣶⡿⠟⠉⢸⣿⡀⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⢠⣿⡟⠁⠀⠀⢸⣿⡄⠀⠀⠀⠀⠀⠀⠀⠉⠛⠻⠿⣿⡿⠟⠻⣷⣾⡿⠛⠉⠀⠀⠀⣸⣿⠃⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠘⣿⣧⣀⠀⠀⠈⣿⣿⣄⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⡇⠀⠀⠀⣀⣴⣿⠏⠀⠀⠀⠀⠀⠀⠀⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠈⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣶⣿⣷⣶⣾⣿⣿⠟⠋⠀
                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠁⠀⠀⠀⠀⠀⠀
'@
   


    $bannerTail = @'
     ____   __   _  _  ____  ____  ____  _  _  ____  __    __       __     __   __       
    (  _ \ /  \ / )( \(  __)(  _ \/ ___)/ )( \(  __)(  )  (  )     (  )   /  \ (  )      
     ) __/(  O )\ /\ / ) _)  )   /\___ \) __ ( ) _) / (_/\/ (_/\ _ / (_/\(  O )/ (_/\    
    (__)   \__/ (_/\_)(____)(__\_)(____/\_)(_/(____)\____/\____/(_)\____/ \__/ \____/    

                    https://Github.com/DTHOMSEN116/SYS-480 
'@

#function to select a random banner from the banners above

    $randomBan = Get-Random -Minimum 1 -Maximum 4
    $banner = if ($randomBan -eq 1) { $banner1 }
    elseif ($randomBan -eq 2) { $banner2 }
    elseif ($randomBan -eq 3) { $banner3 }
    elseif ($randomBan -eq 4) { $banner4 }
    elseif ($randomBan -eq 5) { $banner5 }

    Write-Host -ForegroundColor Cyan $bannerHead 
    Write-Host -ForegroundColor DarkCyan $banner 
    Write-Host -ForegroundColor Cyan $bannerTail

}

function Connect-480([string] $server){
    #are we already connected?
    if ($global:DefaultVIServer){
        Write-Host -ForegroundColor Cyan "Already connected to $($global:DefaultVIServer.Name)"
        return
    }
    else {
        #connect to the server
        Connect-VIServer -Server $server
        Write-Host -ForegroundColor Green "Connected to $server"
    }
}

function Disconnect-480(){
    #are we already connected?
    if ($global:DefaultVIServer){
        Disconnect-VIServer -Server $global:DefaultVIServer -Confirm:$false
        Write-Host -ForegroundColor Green "Disconnected from vcenter.david.local"
    }
    else {
        Write-Host -ForegroundColor Red "Not connected to a server"
    }
}

function Get-480Config([string] $config_path){
    $conf = $null
    if(test-path $config_path){
        $conf= Get-Content -Raw -Path $config_path | ConvertFrom-Json
        $msg = "Configuration file loaded from $config_path"
        Write-Host -ForegroundColor Green $msg
    }
    else {
        $msg = "Configuration file not found at $config_path"
        Write-Host -ForegroundColor Red $msg
    }
    return $conf
}

function Select-Folder(){
    try{
        $folder = $null
        $folders = Get-Folder | Where-Object { $_.Name -in @("BaseVMS", "ProdEnv") }
        $index = 1
        Write-Host ""
        Write-Host "Select a Folder" 
        foreach ($folder in $folders){
            Write-Host -ForegroundColor DarkCyan [$index] $folder.Name
            $index++
        }
        Write-Host ""
        $selection = Read-Host "Select a Folder by number"
        $folder = $folders[$selection-1]
        Write-Host ""
        Write-Host -ForegroundColor Green "Selected Folder: $($folder.Name)"
        return $folder
    }
    catch{
        Write-Host -ForegroundColor Red "Error selecting Folder"
        return $null
    }
}
function Select-VM(){
    try{
        $vm=$null
        $vms = Get-VM -Location $folder
        $index = 1
        Write-Host ""
        Write-Host "Select a VM" 
        foreach ($vm in $vms){
            Write-Host -ForegroundColor Cyan [$index] $vm.Name
            $index++
            }
        Write-Host ""
        $selection = Read-Host "Select a VM by number"
        $vm = $vms[$selection-1]
        Write-Host ""
        Write-Host -ForegroundColor Green "Selected VM: $($vm.Name)"
        return $vm
        }
    catch{
        Write-Host -ForegroundColor Red "Error selecting VM"
        return $null
    }
}

function Select-Datastore(){
    try{
        $ds=$null
        $ds = Get-Datastore | Sort-Object Name
        $index = 1
        Write-Host ""
        Write-Host "Select a Datastore" 
        foreach ($d in $ds){
            $free = [math]::Round($d.FreeSpaceGB, 2)
            Write-Host -ForegroundColor Cyan [$index] $($d.Name) " -- Free Space: $free GB"
            $index++
            }
            Write-Host ""
        $selection = Read-Host "Select a Datastore by number"
        $ds = $ds[$selection-1]
        Write-Host ""
        Write-Host -ForegroundColor Green "Selected Datastore: $($ds.Name)"
        return $ds
        }
    catch{
        Write-Host -ForegroundColor Red "Error selecting Datastore"
        return $null
    }
}

function Select-Snapshot(){
    try{
        $snap=$null
        $snap = Get-Snapshot -VM $vm
        $snap = $snap | Sort-Object Created
        $index = 1
        Write-Host ""
        Write-Host "Select a Snapshot" 
        foreach ($s in $snap){
            Write-Host -ForegroundColor DarkCyan [$index] $s.Name " -- Created: $($s.Created)"
            $index++
            }
        Write-Host ""
        $selection = Read-Host "Select a Snapshot by number"
        $snap = $snap[$selection-1]
        Write-Host ""
        Write-Host -ForegroundColor Green "Selected Snapshot: $($snap.Name)"
        return $snap
        }
            catch{
                Write-Host -ForegroundColor Red "Error selecting Snapshot"
                return $null
            }
        }
        
function changeNetwork(){
    $vm = Select-VM
        
    Write-Host -ForegroundColor Cyan "Listing all networks:"
    $allnw = Get-VirtualNetwork
    $index = 1
    Write-Host ""
    Write-Host "Select a Network"
    foreach ($n in $allnw){
        Write-Host -ForegroundColor Cyan [$index] $n.Name
        $index++
    }
    $newNetwork = Read-Host "Enter the number of the new network for the VM"
    if ($newNetwork -eq "1"){
        $newNetwork = $allnw[0].Name
    }
    else{
        $newNetwork = $allnw[$newNetwork-1].Name
    }
    
    $networkAdapter = $vm | Get-NetworkAdapter
    Set-NetworkAdapter -NetworkAdapter $networkAdapter -NetworkName $newNetwork
}  

function editPower(){
    $vm=Select-VM
        if ($ps -eq "PoweredOff"){
            $ps = $vm.PowerState
            $wps = Write-Host -ForegroundColor Red "Power state: $ps"
            Write-host -ForegroundColor Cyan "Current powerstate of $($vm.Name): $wps"
        }
        else{
            $ps = $vm.PowerState
            $wps = Write-Host -ForegroundColor Green "Power state: $ps"
            Write-host -ForegroundColor Cyan "Current powerstate of $($vm.Name): $wps"
        }    
    Write-Host -ForegroundColor Cyan "Power State:"
    Write-Host -ForegroundColor DarkCyan "1 - Power On"
    Write-Host -ForegroundColor DarkCyan "2 - Power Off"
    $power_state= Read-Host "Select a Power State by number"
        if ($power_state -eq "1"){
            Start-VM -VM $vm -Confirm:$false
            Write-Host -ForegroundColor Green "VM $($vm.Name) powered on"
        }
        elseif ($power_state -eq "2"){
            Stop-VM -VM $vm -Confirm:$false
            Write-Host -ForegroundColor Green "VM $($vm.Name) powered off"
        }
        else{
            continue
        }
}

# Gets network information for a selected VM


function Get-NetworkInfo(){
    $vm = Select-VM
    $guest = Get-VMGuest -VM $vm
    $network = Get-NetworkAdapter -VM $vm
    

    $i = 0
    foreach($adapter in $network){
        $name = $adapter.Name
        $ip = $guest.IPAddress[$i] | Where-Object { $_ -match '\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}' }
        $mac = $adapter.MACAddress
        $subnet = $adapter.SubnetMask

        Write-Host -ForegroundColor Cyan "Network Information for $($vm.Name)"
        Write-Host -ForegroundColor DarkCyan "Network Name: $name"
        Write-Host -ForegroundColor DarkCyan "IP Address: $ip"
        Write-Host -ForegroundColor DarkCyan "MAC Address: $mac"
        Write-Host -ForegroundColor DarkCyan "Subnet: $subnet"
        $i++
    }
}


